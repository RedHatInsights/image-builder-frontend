language: node_js
sudo: required
notifications:
  email: false
node_js:
  - '10'
cache:
  directories:
  - node_modules
before_install:
  - |
        git config --global user.email "travis@image-builder.frontend"
        git config --global user.name "Travis CI"
        git remote add image-builder-frontend https://github.com/${TRAVIS_REPO_SLUG}.git
        git fetch image-builder-frontend $TRAVIS_BRANCH
        git log -1 --pretty=format:%H image-builder-frontend/${TRAVIS_BRANCH}
        git rebase image-builder-frontend/${TRAVIS_BRANCH}
install:
  - npm install
script:
  - npm run travis:verify
  - npx codecov
after_success:
  - curl -sSL https://raw.githubusercontent.com/RedHatInsights/insights-frontend-builder-common/master/src/bootstrap.sh | bash -s
env:
  global:
  - REPO="git@github.com:RedHatInsights/image-builder-frontend-build"
  - REPO_DIR="image-builder-frontend-build"
  - BRANCH=${TRAVIS_PULL_REQUEST_BRANCH:-$TRAVIS_BRANCH}
  - NODE_OPTIONS="--max-old-space-size=4096 --max_old_space_size=4096"
